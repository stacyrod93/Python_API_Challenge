{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import matplotlib.pyplot as plt\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "import requests\n",
    "import gmaps\n",
    "import os\n",
    "import json\n",
    "from pprint import pprint\n",
    "\n",
    "\n",
    "from api_keys import g_key\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>City_ID</th>\n",
       "      <th>City</th>\n",
       "      <th>Cloudiness</th>\n",
       "      <th>Country</th>\n",
       "      <th>Date</th>\n",
       "      <th>Humidity</th>\n",
       "      <th>Lat</th>\n",
       "      <th>Lng</th>\n",
       "      <th>Max Temp</th>\n",
       "      <th>Wind Speed</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>ostrovnoy</td>\n",
       "      <td>2</td>\n",
       "      <td>RU</td>\n",
       "      <td>1558378754</td>\n",
       "      <td>72</td>\n",
       "      <td>68.05</td>\n",
       "      <td>39.51</td>\n",
       "      <td>37.50</td>\n",
       "      <td>7.16</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>mahebourg</td>\n",
       "      <td>75</td>\n",
       "      <td>MU</td>\n",
       "      <td>1558378503</td>\n",
       "      <td>74</td>\n",
       "      <td>-20.41</td>\n",
       "      <td>57.70</td>\n",
       "      <td>78.80</td>\n",
       "      <td>11.41</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>qaanaaq</td>\n",
       "      <td>25</td>\n",
       "      <td>GL</td>\n",
       "      <td>1558378755</td>\n",
       "      <td>73</td>\n",
       "      <td>77.48</td>\n",
       "      <td>-69.36</td>\n",
       "      <td>22.20</td>\n",
       "      <td>2.37</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>zhuhai</td>\n",
       "      <td>0</td>\n",
       "      <td>CN</td>\n",
       "      <td>1558378755</td>\n",
       "      <td>39</td>\n",
       "      <td>40.71</td>\n",
       "      <td>112.04</td>\n",
       "      <td>44.60</td>\n",
       "      <td>4.47</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>cape town</td>\n",
       "      <td>20</td>\n",
       "      <td>ZA</td>\n",
       "      <td>1558378755</td>\n",
       "      <td>76</td>\n",
       "      <td>-33.93</td>\n",
       "      <td>18.42</td>\n",
       "      <td>55.99</td>\n",
       "      <td>8.05</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   City_ID       City  Cloudiness Country        Date  Humidity    Lat  \\\n",
       "0        0  ostrovnoy           2      RU  1558378754        72  68.05   \n",
       "1        1  mahebourg          75      MU  1558378503        74 -20.41   \n",
       "2        2    qaanaaq          25      GL  1558378755        73  77.48   \n",
       "3        3     zhuhai           0      CN  1558378755        39  40.71   \n",
       "4        4  cape town          20      ZA  1558378755        76 -33.93   \n",
       "\n",
       "      Lng  Max Temp  Wind Speed  \n",
       "0   39.51     37.50        7.16  \n",
       "1   57.70     78.80       11.41  \n",
       "2  -69.36     22.20        2.37  \n",
       "3  112.04     44.60        4.47  \n",
       "4   18.42     55.99        8.05  "
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "output_data_file = \"output_data/cities.csv\"\n",
    "\n",
    "weather_df = pd.read_csv(output_data_file)\n",
    "\n",
    "weather_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "gmaps.configure(api_key=g_key)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "3f78af19b1234f9da94dd929545ecf65",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "Figure(layout=FigureLayout(height='420px'))"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "locations = weather_df[[\"Lat\", \"Lng\"]]\n",
    "\n",
    "humidity = weather_df[\"Humidity\"].astype(float)\n",
    "\n",
    "\n",
    "fig = gmaps.figure()\n",
    "\n",
    "heatmap_layer = gmaps.heatmap_layer(locations, weights=humidity,\n",
    "                                   dissipating=False, max_intensity=10,\n",
    "                                   point_radius=1)\n",
    "\n",
    "fig.add_layer(heatmap_layer)\n",
    "\n",
    "fig"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>City</th>\n",
       "      <th>Max Temp</th>\n",
       "      <th>Wind Speed</th>\n",
       "      <th>Cloudiness</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>7</td>\n",
       "      <td>opuwo</td>\n",
       "      <td>72.06</td>\n",
       "      <td>5.44</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>70</td>\n",
       "      <td>ponta do sol</td>\n",
       "      <td>73.68</td>\n",
       "      <td>5.32</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>88</td>\n",
       "      <td>cidreira</td>\n",
       "      <td>76.56</td>\n",
       "      <td>5.50</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>138</td>\n",
       "      <td>morondava</td>\n",
       "      <td>79.08</td>\n",
       "      <td>9.06</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>139</td>\n",
       "      <td>vaini</td>\n",
       "      <td>78.90</td>\n",
       "      <td>1.59</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>176</td>\n",
       "      <td>nador</td>\n",
       "      <td>75.20</td>\n",
       "      <td>6.93</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>297</td>\n",
       "      <td>mogok</td>\n",
       "      <td>72.24</td>\n",
       "      <td>2.77</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>444</td>\n",
       "      <td>birjand</td>\n",
       "      <td>71.60</td>\n",
       "      <td>9.17</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "             City  Max Temp  Wind Speed  Cloudiness\n",
       "7           opuwo     72.06        5.44           0\n",
       "70   ponta do sol     73.68        5.32           0\n",
       "88       cidreira     76.56        5.50           0\n",
       "138     morondava     79.08        9.06           0\n",
       "139         vaini     78.90        1.59           0\n",
       "176         nador     75.20        6.93           0\n",
       "297         mogok     72.24        2.77           0\n",
       "444       birjand     71.60        9.17           0"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "new_df = pd.DataFrame(weather_df, columns = [\"City\", \"Max Temp\", \"Wind Speed\", \"Cloudiness\"])\n",
    "\n",
    "max_temp = (new_df[\"Max Temp\"] <= 80) & (new_df[\"Max Temp\"] > 70)\n",
    "wind_speed = new_df[\"Wind Speed\"] < 10\n",
    "cloudiness = new_df[\"Cloudiness\"] == 0\n",
    "\n",
    "new_df[max_temp & wind_speed & cloudiness]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>City</th>\n",
       "      <th>Country</th>\n",
       "      <th>Lat</th>\n",
       "      <th>Lng</th>\n",
       "      <th>Hotel Name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>ostrovnoy</td>\n",
       "      <td>RU</td>\n",
       "      <td>68.05</td>\n",
       "      <td>39.51</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>mahebourg</td>\n",
       "      <td>MU</td>\n",
       "      <td>-20.41</td>\n",
       "      <td>57.70</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>qaanaaq</td>\n",
       "      <td>GL</td>\n",
       "      <td>77.48</td>\n",
       "      <td>-69.36</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>zhuhai</td>\n",
       "      <td>CN</td>\n",
       "      <td>40.71</td>\n",
       "      <td>112.04</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>cape town</td>\n",
       "      <td>ZA</td>\n",
       "      <td>-33.93</td>\n",
       "      <td>18.42</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>543</td>\n",
       "      <td>yabrud</td>\n",
       "      <td>SY</td>\n",
       "      <td>33.97</td>\n",
       "      <td>36.66</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>544</td>\n",
       "      <td>paraiso</td>\n",
       "      <td>MX</td>\n",
       "      <td>24.01</td>\n",
       "      <td>-104.61</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>545</td>\n",
       "      <td>veraval</td>\n",
       "      <td>FR</td>\n",
       "      <td>49.65</td>\n",
       "      <td>0.71</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>546</td>\n",
       "      <td>novyy urgal</td>\n",
       "      <td>RU</td>\n",
       "      <td>51.07</td>\n",
       "      <td>132.56</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>547</td>\n",
       "      <td>tongren</td>\n",
       "      <td>CN</td>\n",
       "      <td>27.72</td>\n",
       "      <td>109.18</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>548 rows × 5 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "            City Country    Lat     Lng Hotel Name\n",
       "0      ostrovnoy      RU  68.05   39.51           \n",
       "1      mahebourg      MU -20.41   57.70           \n",
       "2        qaanaaq      GL  77.48  -69.36           \n",
       "3         zhuhai      CN  40.71  112.04           \n",
       "4      cape town      ZA -33.93   18.42           \n",
       "..           ...     ...    ...     ...        ...\n",
       "543       yabrud      SY  33.97   36.66           \n",
       "544      paraiso      MX  24.01 -104.61           \n",
       "545      veraval      FR  49.65    0.71           \n",
       "546  novyy urgal      RU  51.07  132.56           \n",
       "547      tongren      CN  27.72  109.18           \n",
       "\n",
       "[548 rows x 5 columns]"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "hotel= pd.DataFrame(weather_df, columns=[\"City\", \"Country\", \"Lat\", \"Lng\"])\n",
    "\n",
    "hotel[\"Hotel Name\"] = \"\"\n",
    "hotel"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0        ostrovnoy\n",
       "1        mahebourg\n",
       "2          qaanaaq\n",
       "3           zhuhai\n",
       "4        cape town\n",
       "          ...     \n",
       "543         yabrud\n",
       "544        paraiso\n",
       "545        veraval\n",
       "546    novyy urgal\n",
       "547        tongren\n",
       "Name: City, Length: 548, dtype: object"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "coordinates_lat_lng = []\n",
    "\n",
    "city = hotel[\"City\"]\n",
    "city"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "{'html_attributions': [], 'results': [], 'status': 'ZERO_RESULTS'}\n"
     ]
    }
   ],
   "source": [
    "coordinates = f\"{hotel['Lat'][0]},{hotel['Lng'][0]}\"\n",
    "search = \"hotel\"\n",
    "radius = 5000\n",
    "type = \"hotel\"\n",
    "\n",
    "params = {\n",
    "    \"location\": coordinates,\n",
    "    \"keyword\": search,\n",
    "    \"radius\": radius,\n",
    "    \"type\": type,\n",
    "    \"key\": g_key}\n",
    "base_url = \"https://maps.googleapis.com/maps/api/place/nearbysearch/json\"\n",
    "\n",
    "response = requests.get(base_url, params=params)\n",
    "pprint(response.json(), depth=1)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'ostrovnoy'"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "hotel.iloc[0][0]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[nan,\n",
       " 'Holiday Inn Mauritius Mon Tresor',\n",
       " 'Qaanaaq Hotel',\n",
       " nan,\n",
       " 'Radisson Blu Hotel Waterfront, Cape Town',\n",
       " 'Pension Temetiu Village',\n",
       " 'Lakeview Hotel Motel',\n",
       " 'Opuwo Country Lodge',\n",
       " 'Umka',\n",
       " 'У лукоморья',\n",
       " 'Hotel Astoria',\n",
       " 'Enjoy Chiloé. Hotel De La Isla',\n",
       " 'The Edgewater Resort and Spa',\n",
       " nan,\n",
       " 'Hotel Gobernador',\n",
       " 'Renaissance Albany Hotel',\n",
       " 'Gostinitsa Viliuisk',\n",
       " 'Los Cauquenes Resort & Spa',\n",
       " 'Laguna Beach Hotel & Spa',\n",
       " 'Angara',\n",
       " 'Alo Resort',\n",
       " 'Esplanade Hotel',\n",
       " 'Domaine de Rochevilaine',\n",
       " 'Hotel Praia Dourada',\n",
       " nan,\n",
       " 'โรงแรมกันตังปาร์ค(Kantang Park Hotel)',\n",
       " 'सूरज होटल कर्नलगंज लखनऊ रोड',\n",
       " 'Hotel Cabo de Hornos',\n",
       " \"Pension Maro'i\",\n",
       " 'Tynwald Willow Bend Estate',\n",
       " 'Goba Lodge',\n",
       " 'Shangri-La Hotel Qingdao',\n",
       " 'Quarter Deck Inn',\n",
       " nan,\n",
       " nan,\n",
       " 'Long House Hotel Bethel',\n",
       " 'AmericInn by Wyndham, Fulton Clinton',\n",
       " 'Huset ved havet',\n",
       " nan,\n",
       " nan,\n",
       " 'The Marine Hermanus',\n",
       " \"Best Western Plus St. John's Airport Hotel and Suites\",\n",
       " 'The Explorer Hotel',\n",
       " 'Humansdorp Boutique Hotel',\n",
       " 'Angermeyer Waterfront Inn',\n",
       " 'Hotel Rosita',\n",
       " nan,\n",
       " nan,\n",
       " 'The Halyards Hotel',\n",
       " nan,\n",
       " nan,\n",
       " 'Grand Hotel Snack',\n",
       " 'دفتردستک محمدسیاه',\n",
       " 'Waldorf Astoria Los Cabos Pedregal',\n",
       " 'Le Rocher de Tahiti',\n",
       " nan,\n",
       " 'Hotel Embassy',\n",
       " nan,\n",
       " 'Hótel Höfn',\n",
       " 'Garuda Hotel Bontang',\n",
       " 'Hampton Inn Sault Ste Marie',\n",
       " 'Gostinichnyy Kompleks Aylgy',\n",
       " 'Best Western Thompson Hotel & Suites',\n",
       " \"Munitsipal'naya Gostinitsa\",\n",
       " 'Hotel Kap Farvel',\n",
       " 'Profilaktoriy Baes',\n",
       " nan,\n",
       " 'Happy Beach Hotel',\n",
       " 'BejaParque Hotel',\n",
       " 'Balneario de Leana',\n",
       " 'Escarpas Resort',\n",
       " nan,\n",
       " 'Isles Sunset Lodge',\n",
       " 'Oceanaire Resort Hotel',\n",
       " nan,\n",
       " nan,\n",
       " 'Hotel Sanches',\n",
       " 'Provintsiya',\n",
       " 'ESTES B&B',\n",
       " 'Hotel Peace Palace, Baglung, Nepal',\n",
       " 'Solscape',\n",
       " 'Jamestown Hotel',\n",
       " 'Sur Plaza Hotel',\n",
       " nan,\n",
       " 'Emerald Star Hotel',\n",
       " 'Peppers Seaport Launceston',\n",
       " 'Tourist House - Sablino',\n",
       " 'Hotel National',\n",
       " 'Pousada Vila Di Italy',\n",
       " 'Puerto Azul Clubhouse',\n",
       " 'PRO LINK HOTEL',\n",
       " 'Dorado Fly Apart',\n",
       " 'Qionghai Hotel',\n",
       " 'Best Western Plus Delta Inn & Suites',\n",
       " 'Park Inn by Radisson, Najran',\n",
       " nan,\n",
       " 'Falls Hotel',\n",
       " 'みかん農家の宿あおとくる（Farmstay aotokuru）/古書ブン(Used bookstore BUN)',\n",
       " 'Baza Otdykha \"Raukhova Mel\\'nitsa\"',\n",
       " nan,\n",
       " 'Kasuari Valley Beach Resort',\n",
       " 'Delta Hotels by Marriott Kingston Waterfront',\n",
       " 'Inn at Creek Street',\n",
       " 'Sheraton Kauai Coconut Beach Resort',\n",
       " nan,\n",
       " 'Chengzi Boutique Hotel',\n",
       " 'Hilo Hawaiian Hotel',\n",
       " 'Westmark Hotel',\n",
       " 'Bonthe Holiday Village',\n",
       " nan,\n",
       " 'Embassy Suites by Hilton Lompoc Central Coast',\n",
       " 'Sinclairs Bayview Port Blair',\n",
       " 'Bredasdorp Country Manor',\n",
       " nan,\n",
       " 'Hotel Karem Bay',\n",
       " 'Le Méridien Bora Bora',\n",
       " 'Keochinda hotel',\n",
       " 'Premier Hotels & Resorts',\n",
       " 'Hotel Xaguate',\n",
       " nan,\n",
       " 'Hotel Internacional',\n",
       " nan,\n",
       " \"Hotel Residence Torre Sant'Angelo\",\n",
       " 'Лагуна',\n",
       " 'Brava Hotel San Felipe',\n",
       " 'Hotel da Canoa',\n",
       " 'Villa Howden',\n",
       " 'Sundog Inn',\n",
       " nan,\n",
       " 'Hotel Marina Del Bay',\n",
       " 'Hotel El Merecure',\n",
       " 'Gostinitsa Ip Zabirov',\n",
       " 'Motel 6 Wendover',\n",
       " 'Hôtel TAKIALT',\n",
       " 'Hotel Castagneto',\n",
       " 'Kibungo - Centre St. Joseph Guest House',\n",
       " 'Accommodations By The Sea',\n",
       " nan,\n",
       " 'Kimony Resort Hotel',\n",
       " 'Dandeli Dreams Jungle resorts',\n",
       " 'Guyana Marriott Hotel Georgetown',\n",
       " nan,\n",
       " 'Tube well mirza rehan',\n",
       " 'Huayan Boutique Hotel',\n",
       " 'Holiday Inn Express & Suites Plainview',\n",
       " 'WAM Hotel Patagónico',\n",
       " nan,\n",
       " 'Hotel Cambri',\n",
       " 'تفضل بيت ضيافة Geust house tafadal',\n",
       " 'Jinjiang International Hotel Ganzhou',\n",
       " 'Talnakh Hotel',\n",
       " nan,\n",
       " \"L'oiseau de Paradis\",\n",
       " 'Hotel Pousada Paradise',\n",
       " \"Claudine's Guesthouse\",\n",
       " 'Snowhotel Kirkenes',\n",
       " 'Hotel Narsaq',\n",
       " 'The Surfside Motel',\n",
       " 'Avada Hotel',\n",
       " 'Four Points by Sheraton Manado',\n",
       " 'Residence la Gancia',\n",
       " 'Pousada Kactus',\n",
       " nan,\n",
       " 'Parkside Inn',\n",
       " 'Hyatt Regency Kathmandu',\n",
       " 'Heritage Hotel',\n",
       " 'Holiday Inn Express & Suites Brainerd-Baxter',\n",
       " '玉门阳光酒店',\n",
       " 'Jægtvolden Fjordhotell',\n",
       " 'Hotel Porto Santo & Spa',\n",
       " nan,\n",
       " nan,\n",
       " 'Hotel Belle Vue',\n",
       " 'Nusa Island Retreat',\n",
       " 'Zabalanquira Hotel De Montaña',\n",
       " 'Naujaaraaluit – Clyde River Hotel',\n",
       " 'Hotel Marchica Lagoon Resort, Nador Morocco',\n",
       " 'Hotel Keflavik',\n",
       " nan,\n",
       " nan,\n",
       " 'Orcéa Ecofriendly & SPA',\n",
       " 'The Red House',\n",
       " nan,\n",
       " 'The Royal Grand Hotel',\n",
       " 'Beach Hotel Burnie',\n",
       " nan,\n",
       " 'Yamada Onsen Genenro',\n",
       " nan,\n",
       " 'Tivoli Carvoeiro Algarve Resort',\n",
       " 'Bluff Hotel',\n",
       " 'Le Georgesville, centre de congrès et hôtel',\n",
       " 'Polar Capital',\n",
       " 'The Esplanade Hotel',\n",
       " 'Pebbles Inn',\n",
       " nan,\n",
       " 'Coraki Hotel',\n",
       " 'Hotel Arctic',\n",
       " 'Hotel Boutique Costa Del Sol',\n",
       " 'Mauricia Beachcomber Resort & Spa',\n",
       " 'KAABONG RESORT HOTEL',\n",
       " 'Hotel Rincon Campestre',\n",
       " 'Hotel Continental Luanda',\n",
       " 'Hotel Patagonia',\n",
       " 'Namatanai Hotel',\n",
       " 'Kak Doma',\n",
       " 'Jinyi Jinglan Hotel',\n",
       " nan,\n",
       " nan,\n",
       " nan,\n",
       " 'Yeet Hotel',\n",
       " 'Quinta Das Buganvílias',\n",
       " nan,\n",
       " 'The Old Mount Gambier Gaol',\n",
       " 'Posada el portal de la Loma',\n",
       " 'Isa Hotel',\n",
       " 'Les Deux Vélos Cycle Lodge',\n",
       " 'Hotel Grand Chancellor Hobart',\n",
       " 'Clontarf Castle Hotel',\n",
       " 'Al Baleed Resort Salalah by Anantara',\n",
       " nan,\n",
       " nan,\n",
       " 'Marawi Resort Hotel',\n",
       " 'LA QUINTA PRIMAVERA',\n",
       " 'ORW Julia',\n",
       " nan,\n",
       " 'Carnarvon Hotel',\n",
       " 'MOB HOTEL',\n",
       " 'Amir hotel',\n",
       " 'Howard Johnson Hotel & Marinas San Pedro Resort',\n",
       " nan,\n",
       " 'Holiday Inn Express & Suites Moses Lake',\n",
       " 'ROYAL STAR',\n",
       " 'Sheraton Hamilton Hotel',\n",
       " 'Dreamsea Surf Resort Nicaragua',\n",
       " nan,\n",
       " 'RedDoorz @ Cisaga',\n",
       " nan,\n",
       " 'Hotel Dela Inn',\n",
       " 'Hotel Royal',\n",
       " 'Manzhouli Shangri-La Hotel',\n",
       " 'Commercial Hotel',\n",
       " 'Chukotka hotel',\n",
       " 'REER XOOSHLE GROUP',\n",
       " 'Motelʹ 57 Km',\n",
       " '3G hotel pasni',\n",
       " 'End of The Road Ltd.',\n",
       " 'Gostinitsa \"Sakhalin-Sfera\"',\n",
       " 'Bungalows Zicatela',\n",
       " 'Panamericana Hotel Ancud',\n",
       " 'Afro Legacy Hotel',\n",
       " 'Port Lincoln Hotel',\n",
       " nan,\n",
       " 'Karolineburg Manor House Hotel',\n",
       " 'Adelaide Road Motor Lodge',\n",
       " 'Hotel Trocadero',\n",
       " nan,\n",
       " 'Hotel Diana',\n",
       " 'Hôtel Loisirs Mandji',\n",
       " 'Te Anau Lakeview Kiwi Holiday Park & Motels',\n",
       " 'Hami Hotel',\n",
       " 'Pahrump Nugget',\n",
       " 'Copper River Inn',\n",
       " 'Mayfair Hotel',\n",
       " 'Hotel Soyuz',\n",
       " 'Iloha Seaview Hotel',\n",
       " 'Thuraya Tourist Hotel',\n",
       " 'DoubleTree by Hilton Hotel Alice Springs',\n",
       " 'Hotel Roraima Suites',\n",
       " nan,\n",
       " 'Turtle Nest Inn',\n",
       " 'The Griff Motel',\n",
       " 'Hotel Dreams de la Patagonia',\n",
       " 'Terraço Hotel',\n",
       " 'Posada Piedras Blancas',\n",
       " 'Samuels Hotel',\n",
       " 'Sesc Iparana - Hotel Ecológico',\n",
       " 'Pedras do Mar Resort & SPA',\n",
       " 'Kinwica',\n",
       " 'Grand Hotel Montabo',\n",
       " nan,\n",
       " 'Hacienda Hato Verde',\n",
       " '別邸 海と森',\n",
       " 'Holiday Inn Express & Suites Slave Lake',\n",
       " 'BreakFree on Cashel Christchurch',\n",
       " nan,\n",
       " 'Obelix Guesthouse',\n",
       " \"Trishcia's Guest House\",\n",
       " 'Pangnirtung Fjordview Bed and Breakfast',\n",
       " nan,\n",
       " 'Robin Hood Village Resort',\n",
       " 'Hotel Viktoria',\n",
       " 'Hotel Florida',\n",
       " 'Club Mahindra Madikeri Resort In Coorg',\n",
       " 'Bentley 24hr Room Accommodation',\n",
       " 'Protea Hotel by Marriott Takoradi Select',\n",
       " 'Gostinitsa Lyuks',\n",
       " nan,\n",
       " 'Mount Mogok Hotel',\n",
       " 'Original Sokos Hotel Vaakuna, Mikkeli',\n",
       " 'Jiuquan Hotel',\n",
       " nan,\n",
       " nan,\n",
       " 'Taloa Heights',\n",
       " 'Sails in the Desert',\n",
       " 'Ooo \"Kvarkeno\"',\n",
       " 'Hotel Concha do Mar',\n",
       " nan,\n",
       " 'Distinction Dunedin Hotel',\n",
       " nan,\n",
       " 'Café de Upernavik',\n",
       " nan,\n",
       " 'Nebitchi Hotel',\n",
       " 'Gostinitsa \"Polar\"',\n",
       " 'House otdaha locomotive crews',\n",
       " 'Эрхэт зочид буудал',\n",
       " 'Hotel Yanuba, Miraflores',\n",
       " 'Footsteps Eco Lodge, The Gambia',\n",
       " 'Noto no Sho Ryokan',\n",
       " 'Maringe Lagoon Lodge',\n",
       " 'Pousada Gargalheiras',\n",
       " 'HOTEL CASCADES PALACE',\n",
       " 'Granada Hotel Mandera',\n",
       " 'Hotel Paradis',\n",
       " 'Four Points by Sheraton Juneau',\n",
       " 'Holiday Inn Express & Suites Sidney',\n",
       " nan,\n",
       " 'Osprey Beach Hotel',\n",
       " 'Hotel Sunroute Goshogawara',\n",
       " 'The IMPERIAL Hotel',\n",
       " \"Cork's Vienna Woods Hotel and Holiday Homes\",\n",
       " nan,\n",
       " 'Beach Hotel Sunshine',\n",
       " 'Golden Shore Resort',\n",
       " 'Zodiak Mini Hotel',\n",
       " nan,\n",
       " 'Mango hotel',\n",
       " 'Ngwe Sin Kyal Guest House unit 2',\n",
       " 'Holiday Inn Resort Acapulco',\n",
       " 'Ambleside',\n",
       " nan,\n",
       " 'Mint Hotel',\n",
       " 'Onway Lake Family Resort',\n",
       " 'Wyndham Tortola BVI Lambert Beach Resort',\n",
       " 'Gostinitsa Po Domashnemu',\n",
       " 'いわない高原ホテル',\n",
       " 'Hotel Eseka Palace',\n",
       " 'Palm Tree Place',\n",
       " nan,\n",
       " nan,\n",
       " nan,\n",
       " nan,\n",
       " 'Hôtel Opémiska',\n",
       " nan,\n",
       " 'Comfort Hotel',\n",
       " nan,\n",
       " nan,\n",
       " 'The Grand Dragon Ladakh',\n",
       " 'Hotel Kyriad Muraya',\n",
       " 'Groote Eylandt Lodge',\n",
       " 'Lofoten Værøy Brygge',\n",
       " 'Lakeview Inns & Suites - Fort Nelson',\n",
       " 'Crown Victoria Hotel',\n",
       " 'Garden Hotel',\n",
       " 'Pestana Bahia Praia',\n",
       " 'Hotel Kea by Keahotels',\n",
       " 'Bannisters by the Sea',\n",
       " 'Alexander Beketov Guesthouse',\n",
       " nan,\n",
       " 'Malaya Gostinitsa',\n",
       " 'Alpine Hotel',\n",
       " 'Motel Valentina',\n",
       " 'Pazo do Souto',\n",
       " 'Toutei The Japanese-style',\n",
       " 'Gostinitsa',\n",
       " 'Outeiro do Barro',\n",
       " 'Hilton Garden Inn Fort Walton Beach',\n",
       " 'Shangri-la Hotel,Qinhuangdao',\n",
       " 'Shoreline Inn & Conference C, Ascend Hotel Collection',\n",
       " 'Gostinitsa Grenada',\n",
       " nan,\n",
       " 'Radisson Blu Hotel Kayseri',\n",
       " 'InterContinental Quanzhou',\n",
       " 'Hotel Lake Garda',\n",
       " 'Holiday Inn Express & Suites Medicine Hat Transcanada Hwy 1',\n",
       " nan,\n",
       " 'Hotel Appel',\n",
       " 'The Mill Casino • Hotel & RV Park',\n",
       " 'Paitití Hostel',\n",
       " 'Victoria Bed & Breakfast',\n",
       " 'Jolysable',\n",
       " 'The Harbour Inn',\n",
       " 'Hotel ibis Styles Iu Namibe',\n",
       " 'Westport Coast Hotel',\n",
       " 'Hotel ibis Juiz de Fora',\n",
       " 'Lagos Continental Hotel',\n",
       " 'Beach House - Half Moon Bay',\n",
       " 'Hotel Nelson - Formerly The Nelson Resort',\n",
       " 'Last Light Lodge',\n",
       " 'Mar Guesthouse',\n",
       " 'Sofitel Xining',\n",
       " nan,\n",
       " 'Sikakubete Guest House Kalabo Town Council',\n",
       " 'Carrefour',\n",
       " nan,\n",
       " 'اوتيل City Stay',\n",
       " 'Dorsett Grand Labuan',\n",
       " 'DoubleTree by Hilton Hotel Pittsburgh - Cranberry',\n",
       " 'Tunka-350',\n",
       " 'Cristal Palace Hotel',\n",
       " 'ECO Lifestyle & Lodge',\n",
       " 'PECTORIA Guest House',\n",
       " \"Mary-Ann's Polarrigg\",\n",
       " 'Azzaro Resorts & Ganga Spa',\n",
       " 'База отдыха \"Динамо\" Семинский перевал',\n",
       " 'Sarwary Hotel',\n",
       " nan,\n",
       " 'Kirkuk Plaza Hotel',\n",
       " 'Hotel Les Rochers',\n",
       " 'Beach Abode Beachfront Lodge',\n",
       " 'Bayhaven Lodge',\n",
       " 'Manmimar Nature Lodge',\n",
       " 'InterContinental Carlton Cannes',\n",
       " 'Gostinitsa Susumanzoloto',\n",
       " 'Hotel Liebl',\n",
       " 'Hotel Karysmã',\n",
       " 'Hotel Bahia',\n",
       " nan,\n",
       " 'Mangapapa Hotel',\n",
       " 'Prozhivaniye V Okhotske',\n",
       " 'Hotel Maniitsoq',\n",
       " 'Hotel Meuligoe',\n",
       " 'Hotel Los Corceles',\n",
       " 'Hotel Gamboa',\n",
       " nan,\n",
       " 'Dorsett Grand Labuan',\n",
       " 'Ban Mai Hotel',\n",
       " 'Rahat Hotel',\n",
       " 'Sunset Inn & Suites',\n",
       " 'The Old Lodge B&B',\n",
       " 'Hotel Marilu',\n",
       " 'Busta House Hotel',\n",
       " 'Gostinitsa Ivushka',\n",
       " 'The Old Orchard Guest House',\n",
       " nan,\n",
       " 'Sepehr Hotel',\n",
       " 'Lees Hotel',\n",
       " 'De Duine Hotel',\n",
       " nan,\n",
       " 'Sharq Village & Spa, a Ritz-Carlton Hotel',\n",
       " \"Marriott's Ko Olina Beach Club\",\n",
       " 'Seeadler Bay Hotel',\n",
       " 'Hotel Route Inn Anan',\n",
       " nan,\n",
       " nan,\n",
       " 'Hotel Amazor',\n",
       " 'Nanxiang Barony Hotel',\n",
       " nan,\n",
       " 'Best Western Pioneer Inn',\n",
       " 'Castle House Hotel',\n",
       " 'Nuevo Hotel Argentino',\n",
       " nan,\n",
       " 'Hotel Amazonas',\n",
       " 'Lighthouse Lodge & Cottages',\n",
       " 'PACIFIC HOTEL',\n",
       " nan,\n",
       " nan,\n",
       " 'Apartment on Begicheva 24',\n",
       " nan,\n",
       " 'Hotel Torre Luz',\n",
       " 'Tierra Alta Ecolodge',\n",
       " 'Sunotel Aston, Barcelona',\n",
       " nan,\n",
       " 'BIG4 Sawtell Beach Holiday Park',\n",
       " 'StayB Hotel Myeongdong',\n",
       " 'The Junction Boutique Hotel',\n",
       " 'Hotel Riu Palace Aruba',\n",
       " 'Quinta da Ribeira',\n",
       " 'Burnett Riverside Hotel',\n",
       " 'Swiss-Belhotel Borneo Samarinda',\n",
       " 'Kosmos',\n",
       " nan,\n",
       " 'Seasons Hotel Narok',\n",
       " \"Ye-Otel'\",\n",
       " 'Hotel Ñikén Spa & Business Center',\n",
       " 'Hotel MarSur',\n",
       " 'Hôtel Sophia',\n",
       " 'Radisson Hotel Bismarck',\n",
       " nan,\n",
       " 'Kashinin Hotel Ethiopia',\n",
       " nan,\n",
       " 'Romka Holiday Inn',\n",
       " nan,\n",
       " nan,\n",
       " 'Hotel Hans Egede',\n",
       " nan,\n",
       " 'Lavande Hotel Fuxin 318 Park',\n",
       " nan,\n",
       " 'Holiday Inn Express and Suites Havelock',\n",
       " 'Hotel Indigo Traverse City',\n",
       " 'Hotel Veleros Champoton',\n",
       " 'Mandal Hotel',\n",
       " 'Hotel ibis Delemont Delsberg',\n",
       " 'Bo Khin Guest House',\n",
       " nan,\n",
       " 'Tutóia Pousada Jagatá',\n",
       " 'Casa Imperial Luxo',\n",
       " 'ASMOREIN HOTEL',\n",
       " 'Drostdy Hotel',\n",
       " 'Le Méridien Noumea Resort & Spa',\n",
       " 'Ramada by Wyndham Emerald Park/Regina East',\n",
       " 'Bab Sahara',\n",
       " 'Hotel Shimamoto',\n",
       " 'Natchez Grand Hotel',\n",
       " 'Grand Kesambi Resort and Villas',\n",
       " 'Keinnara Loikaw',\n",
       " nan,\n",
       " 'Sandies Tropical Village',\n",
       " 'Hotel Mansons Plaza',\n",
       " 'Zagaia Eco Resort',\n",
       " \"Henry's Fork Inn\",\n",
       " 'Days Inn by Wyndham High Prairie',\n",
       " 'Ocean Pearl Bonefishing Resort',\n",
       " 'Ulvesund FYR',\n",
       " 'Hotel Kununurra',\n",
       " 'Dolphin Hotel',\n",
       " 'Hotel Pullman Zamzam Makkah',\n",
       " 'Hotel Austral Viedma',\n",
       " 'Hotel Hacienda Vieja',\n",
       " nan,\n",
       " 'Harbourview Bed & Breakfast',\n",
       " 'Hotel Atoll Emerald Miyakojima',\n",
       " 'Esplendor by Wyndham Mendoza',\n",
       " 'Key-oh Lodge',\n",
       " 'Vaihmalan Hovi',\n",
       " nan,\n",
       " 'Hotel Alavera',\n",
       " 'Mercure Padang',\n",
       " 'Hotel de Matam',\n",
       " 'Grand Hotel des Sablettes Plage, Curio Collection by Hilton',\n",
       " 'Swiss-Belhotel Palu',\n",
       " 'Taverna U Dyadi Viti',\n",
       " 'Powerhouse Hotel Tamworth by Rydges',\n",
       " 'The Station Hotel',\n",
       " nan,\n",
       " 'Hotel Casa Ma Elena',\n",
       " 'B&B HOTEL',\n",
       " nan,\n",
       " 'Chuxi Hotel']"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "hotel_name = []\n",
    "\n",
    "params = {\n",
    "    \"radius\": 5000,\n",
    "    \"types\": \"hotel\",\n",
    "    \"keyword\": \"hotel\",\n",
    "    \"key\": g_key\n",
    "}\n",
    "\n",
    "for index, row in hotel.iterrows():\n",
    "    lat = row[\"Lat\"]\n",
    "    lng = row[\"Lng\"]\n",
    "\n",
    "    params[\"location\"] = f\"{lat},{lng}\"\n",
    "\n",
    "    base_url = \"https://maps.googleapis.com/maps/api/place/nearbysearch/json\"\n",
    "\n",
    "    name_address = requests.get(base_url, params=params)\n",
    "    \n",
    "    name_address = name_address.json()\n",
    "    try:\n",
    "        hotel_name.append(name_address['results'][0]['name'])\n",
    "    except IndexError:\n",
    "        hotel_name.append(np.nan)\n",
    "        \n",
    "hotel_name"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [],
   "source": [
    "hotel['Hotel Name']= hotel_name\n",
    "hotel.dropna()\n",
    "hotel.to_csv('hotel_export.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [],
   "source": [
    "info_box_template = \"\"\"\n",
    "<dl>\n",
    "<dt>Name</dt><dd>{Hotel Name}</dd>\n",
    "<dt>City</dt><dd>{City}</dd>\n",
    "<dt>Country</dt><dd>{Country}</dd>\n",
    "</dl>\n",
    "\"\"\"\n",
    "\n",
    "hotel_info = [info_box_template.format(**row) for index, row in hotel.iterrows()]\n",
    "locations = hotel[[\"Lat\", \"Lng\"]]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "3f78af19b1234f9da94dd929545ecf65",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "Figure(layout=FigureLayout(height='420px'))"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "markers = gmaps.marker_layer(locations)\n",
    "fig.add_layer(markers)\n",
    "fig"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
